!function(){"use strict";var o={},d={};function t(t,e){var a={};try{a=JSON.parse(localStorage[t])}catch(e){delete localStorage[t]}return a.task||(a.task={}),"function"==typeof e?e(a):a}d.el={},d.hashData={},d.pageSchema={fullPackage:"full",sessionInterval:7,package:{closet:void 0,shopping:void 0,full:{title:"ברוכה הבאה לקורס סטייל שבא מבפנים",shortTitle:"סטייל שבא מבפנים",video:"yCsI9dSOvK0",session:{colours:{title:"הצבע הזה הוא אני",video:"6fuubXrOQ6c",page:{colorPlates:{title:"לוחות צבעים",video:"_dohRGGGLmQ"},colorSwatch:{title:'ערכת "צבע מבפנים"',question:{option:{hair:{question:"באיזה צבע השיער שלך?",answer:{black:"שחור",darkBrown:"חום כהה",mediumBrown:"חום בינוני",lightBrown:"חום בהיר",honey:"דבש",brightBlond:"בלונד בהיר",darkBlond:"בלונד כהה",redhead:"ג'ינג'י",chestnut:"ערמוני",blondeGray:"בלונד אפור",lightGray:"אפור בהיר",mediumGray:"אפור בינוני",grayGray:"שיבה אפור",mousey:"עכברי",silver:"כסוף"}},eyes:{question:"באיזה צבע העיניים שלך?",answer:{brown:"חום",darkBrown:"חום כהה",honeyBrown:"חום דבש",greenishBrown:"חום ירקרק",lightGray:"אפור בהיר",greenish:"ירקרק",brightGreen:"ירוק בהיר",oliveGreen:"ירוק זית",darkGreen:"ירוק כהה",blue:"כחול",lightBlue:"כחול בהיר",blueGreen:"כחול ירוק"}},skin:{question:"מה גוון העור שלך?",answer:{tan:"שזוף",bright:"בהיר",dark:"כהה"}}},address:"כתובת מלאה לשליחת דואר",error:"תעני על כל השאלות",button:"אשר הזמנה"}}}},bodyShape:{title:"כמה טוב להיות את",video:"xZMfS-HXqXM",page:{bodyType:{title:"מחשבון מבנה הגוף",value:"1gKI_JUyD20fvq27_B3Kxq9vfJ6f99xLnnd1ht1vibhU",button:"הצג תוצאה",notice:"שימי לב, חישוב ניתן רק לפעם אחת",result:"את בעלת מבנה גוף {0}",download:"להורדת מדריך הגיזרות",error:"שגיאה בחישוב, {0}נא לפנות ללאה{1}",option:{height:'הגובה (ס"מ)',shoulders:"היקף הכתפיים",bust:"היקף החזה",waist:"היקף המותניים",hips:"היקף הירכיים"}}}},style:{title:"על טעם, ריח, ואופי",video:"06Q_GGX5KLQ",page:{dressStyle:{title:"מחשבון סגנון הלבוש",next:"המשך",back:"חזור",button:"הצג תוצאה",limit:"סמני מקסימום שתי תשובות",value:"academy-style.jpg",option:[{title:"כיצד את בוחרת את צבעי הבגדים שלך?",option:{A:"בהתאם למצב רוח שלי באותו יום",B:"צבעים חזקים וקונטרסטים",C:"צבעי פסטל",D:"פריטי לבוש המתאימים מבחינת הצבעים, הבדים או הדוגמאות",E:"בשילובי צבעים ניטרליים ופשוטים או בצבעי אדמה"}},{title:"כיצד תגדירי את סגנון הקניות שלך?",option:{A:"אוהבת לקנות בשווקים, יד שניה ובמבצעים",B:"קונה בלי לחשוב פעמיים כל דבר שמוצא חן בעיני",C:"הקניות עושות אותי שמחה ואני נהנת, אני יוצאת לקניות כשאני רוצה לשפר מצב רוח שלי",D:"הקניות שלי מתוכננות ונעשות על פי רשימה מוכנה מראש, משקיעה בפריטים איכותיים וקלאסיים שתמיד באופנה",E:"קונה בהתאם לצורך או לקראת אירועים מיוחדים. לא מוכנה לוותר על נוחות, במקרה הצורך אלך לתופרת"}},{title:"כיצד היית מגדירה את הופעתך באופן כללי?",option:{A:"בעלת סגנון ייחודי המשלב פריטים שונים ויוצאי דופן",B:"בעלת אמירה אופנתית ופריטים המושכים תשומת לב",C:"אוהבת בגדים עם קישוטים עדינים הגורמים לי להרגיש נשית",D:"נקי ואלגנטי",E:"אוהבת בגדים נוחים"}},{title:"איזה מהפריטים בארון שלך משמשים אותך לעבודה?",option:{A:"פריטי לבוש אקראיים שאני מערבבת ביניהם לפי טעמי האישי",B:"פריטים יוצאי דופן שתופסים את העין",C:"חולצות יפות ועליוניות שאני משלבת עם חצאיות",D:"פריטים בסיסיים הניתנים לשדרוג עם אביזרים, פריטים מחויטים",E:"פריטי לבוש יום יומיים, כמו מכנסי ג'ינס וחולצה פשוטים"}},{title:"איזה מהפריטים בארון שלך משמשים אותך לשעות הפנאי?",option:{A:"אוסף פריטי לבוש בסגנון רטרו או וינטאג'",B:"הפריטים האופנתיים שנרכשו לאחרונה",C:"פריטים יפים ונשיים, עם תחרות",D:"פריטים בעלי סגנון פשוט שלהם אני מוספיה אביזרים",E:"בגדים נוחים ואיכותיים, מכותנה או פשתן, טוניקות"}},{title:"איזה מהפריטים בארון שלך שמורים לאירועים מיוחדים?",option:{A:"שילבו בדים מיוחדים או גזרות מעניינות",B:"פריטים מיוחדים וגרנדיוזיים המושכים תשומת הלב",C:"שמלות נשיות וקלילות ומקושטות ועשויים מבדים קלילים",D:"חליפה אלגנטית ומחויטת או שמלה קלאסית וסולידית בשילוב תכשיטים אופנתיים",E:"חצאית אלגנטית ארוכה ונוחה או מכנסיים בשילוב עם חולצה נוחה וחגיגית או טוניקה"}},{title:"כיצד תתארי את הנעליים שלך?",option:{A:"לאו דווקא מתאימות ללבוש שלי אבל מיוחדות",B:"לרוב בעלות עקבים",C:"יפות עם סרטים או קישוטים",D:"קלאסיות, מתאימות להרבה בגדים",E:"נוחות ושטוחות"}},{title:"איזה סוג תכשיטים את אוהבת?",option:{A:"לא שגרתיים, ממש פריטי אספנות",B:"גדולים ובעלי אמירה אישית",C:"מורכבים ועשירים מאוד בפריטים, עם סלסולים ופרחים",D:"בעלי קו מעודן וקלאסי, עשויים מזהב או כסף",E:"עשויים בדרך כלל מחומרים טבעים"}},{title:"מהו יחסך לנושא האיפור?",option:{A:"אוהבת להתנסות בדברים חדשים ומתחדשים כל הזמן",B:"אוהבת אותו מודגש וקצת מוגזם",C:"אוהבת ומשקיעה בו זמן רב",D:"לא מחדשת, דבקה בהרגלים שלי, אבל חשוב ומשלים את ההופעה שלי",E:"מינימליסטי, אם בכלל"}},{title:"מהו סגנון כיסוי ראש / שיער שלך?",option:{A:"משתנה בהתאם למצב הרוח שלי",B:"משתנה בקביעות, משתנה בצבעוניות",C:"אוהבת להוציא שיער בצדדים. שיער ארוך",D:"מעודן ומשתלב עם הלבוש שלי",E:"דורש תחזוקה מינימלית"}},{title:"כשאת בוחרת חולצה מודפסת היא תהיה____?",option:{A:"הדפס בסגנון חדש, שאין לי בארון",B:"הדפס דומיננטי",C:"עדין עם נקודות או פרחים קטנים",D:"בדרך כלל קונה פריטים ללא הדפס",E:"אוהבת חלק וגם אוהבת הדפס אתני"}},{title:"באיזה סגנון את רואה את עצמך מתלבשת?",limit:"סמני תשובה אחת",showImage:!0,condition:function(e){var t,a,n=ui.academy.schema.final,i=this.id&&ui.d.getElementById(this.id);if(e={C:["C","F"],E:["E","G"],CD:["C","D"]}[JSON.stringify(e).replace(/[[,\]"]/g,"")],this.option={},Array.isArray(e))for(a=0;a<e.length;a+=1)this.option[e[a]]=n[e[a]];return t=!!Object.keys(this.option).length,i&&t&&this.callback&&(i.innerHTML=this.callback.apply(null,this.params).replace(/^<li\b[^>]*>|<\/li>$/g,"")),t}}],final:{C:"רומנטי",D:"קלאסי",E:"טבעי",F:"בוהומייני",G:"קז'ואל"},downloadButton:"להורדת חוברת הסגנון"}}},modularOutfit:{title:"יש לך מה ללבוש",video:"_VYx-UC-VqU",download:{title:"להורדת חוברת מערכת פריטי הבסיס",link:"https://drive.google.com/uc?export=download&id=1kTlj1ZOXh8YQQyJCRuwBoShIfGKkUpLp"}},accessories:{title:"התוספת שתופסת",video:"fOYZbRKMYAE",page:{coversShoes:{title:"מטפחות ונעליים",video:"JWTBhFri44w",download:{title:"להורדת חוברת האקססוריז",link:"https://drive.google.com/uc?export=download&id=1wPOeaV2Y1xKnOsoOR1VevgU-g0L95cGO"}},matchHeadcover:{title:"בונוס התאמה למבני הפנים",video:"XW4S6zGtGic"}}},lingerie:{title:"יסודות למראה חטוב",video:"qk0-_Dnf3Z4",page:{material:{title:"צבע, בד וגזרה בהלבשה תחתונה",shortTitle:"הלבשה תחתונה",video:"IpwM9HEeup4",download:{title:"להורדת חוברת הלבשה התחתונה",link:"https://drive.google.com/uc?export=download&id=1E8QTzqkLoWk23ht-BUCHt77QRoYCOuhc"}}}},closet:{title:"מיני קורס ארון מדויק",shortTitle:"ארון מדויק",highlight:function(){if(d.containsPackage(d.pageSchema.fullPackage))return"בונוס"},video:"KzC7tJRjxqc",text:function(){if(!d.containsPackage(d.pageSchema.fullPackage)&&!d.containsPackage("shopping"))return"מיני קורס קניות ממוקדות הוא למעשה תיעוד של סיבוב קניות אמיתי. הקורס מלמד איך מזהים את הבגד שיחמיא לך, עוד לפני שמודדים. בתור משתתפת מיני קורס ארון מדויק מגיע לך הנחה של [20% על קורס קניות](/payment#orderid=66321B17)."},page:{clearingCloset:{title:"פינוי ארון",video:"FiMXsvqCDZ8"},bodyType:void 0,orderCloset:{title:"סדר תכלס",video:"ZzK_ol7qLPs",download:{title:"להורדת חוברת ארון הקסמים",link:"https://drive.google.com/uc?export=download&id=1Ee5Zh92agzw6qkRsKE40t4zpwiw-DQTg"}},clothesSum:{title:"מחשבון כמויות הבגדים",question:{option:{shabbat:{question:"כמה סטים את לובשת בשבת?",answer:{1:1,2:2,3:3}},dress:{question:"האם את נוהגת ללבוש שמלות?",answer:{yes:"כן תמיד",no:"בכלל לא",shabbat:"רק בשבתות",sometimes:"לפעמים"}},cover:{question:"האם את נוהגת ללבוש מטפחות או כובעים?",answer:{yes:"כן",no:"לא"}}},error:"תעני על כל השאלות",button:{success:"המשך"}},activity:{label:["סוג הפעילות","כמות הפעילויות בחודש"],option:{job:"ימי עבודה",evening:"בילוי ערב",shabbat:"שבת",sport:"ספורט","":"אחר"},error:"תמלאי לפחות שדה אחד",button:{back:"חזור",create:"להוסיף פעילות נוספת",remove:"הסר",success:"חישוב"}},sum:{label:["סוג",'ס"כ הבגדים','ס"כ שילובים'],option:{cover:{title:"מטפחות",perc:22},chain:{title:"שרשראות נוכחות",perc:5},bag:{title:"תיקים",perc:5},shoe:{title:"נעליים",perc:11}},sets:{dress:"שמלות",jacket:"ז'קטים",shirt:"חולצות",skirt:"חצאיות"},button:{retry:"חישוב מחדש"}}},winterClothes:{title:"בגדי חורף",video:"2_QEgMc6ieg",pinterest:"https://www.pinterest.com/lealaukstein/סטייל-בחורף/"}}},shopping:{title:"מיני קורס קניות ממוקדות",shortTitle:"קניות ממוקדות",highlight:function(){if(d.containsPackage(d.pageSchema.fullPackage))return"בונוס"},video:"ar7Ly0L-LVk",text:function(){if(!d.containsPackage(d.pageSchema.fullPackage)&&!d.containsPackage("closet"))return"מיני קורס ארון מדויק הוא למעשה תיעוד של סידור ארון אמיתי. הקורס מלמד לבנות ארון בגדים מדויק - לזהות פריטים מדליקים, להוציא פריטים שלא מחמיאים, לסדר שהכל יהיה נגיש, ולבנות רשימת קניות בהתאם לכל סוגי הפעילויות שלך.\nבתור משתתפת מיני קורס קניות ממוקדות מגיע לך הנחה של [20% על הקורס ארון](/payment#orderid=8A572215)."},page:{shoppingList:{title:"רשימת קניות",video:"H-jZdaa00jE"},internalExternal:{title:"פנימיות וחיצוניות",video:"9ybTp1UqeCU"},colorSwatch:void 0,bodyType:void 0,dressStyle:void 0,doShopping:{title:"תכלס קניות",video:"dA13_gg6bA8"},onlineShopping:{title:"קניות אונליין",video:"9MQ6oTxeKMU"}}}}}}},d.endpoint=function(){for(var e=(location.hostname||location.host).split(".");2<e.length;)e.shift();return"https://lab."+e.join(".")+"/webhook"}(),d.sessionData=t("session",function(e){return e.email&&e.token?e:t("user",function(e){return e.email&&e.token&&(localStorage.session=localStorage.user,delete localStorage.user,ui.setUser(e)),e})}),d.sessionLogedin=function(){ui.d.documentElement.classList.remove("stretch"),ui.d.documentElement.classList.add("logedin"),d.el.details.remove(),d.el.account=ui.d.getElementById("account"),d.el.account.outerHTML='<div class=profile>    <img src="https://gravatar.com/avatar/'+d.sessionData.avatar+'?s=42&r=g&d=mm">    <div class="table center">        <div class=cel>'+(d.sessionData.firstname?"<div class=nowrap dir=auto>"+d.sessionData.firstname+"</div>":"")+"            <small onclick=ui.academy.sessionLogout()>התנתקי</small>        </div>    </div></div>",delete d.el.details,delete d.el.account;var l=d.hashData.session,n=d.pageSchema.package,c={generateEvents:function(e,t){return" onclick=ui.academy.navClick(this) onkeydown=ui.academy.navKeydown(event)"+(e?" data-session="+e:"")+(t?" data-page="+t:"")+" tabindex="+(t?-1:0)},generateDateObject:function(e){e=e||{};var t=new Date(e.startDate.setDate(e.startDate.getDate()+(e.sessionInterval?e.sessionInterval*d.pageSchema.sessionInterval:e.firstSession?0:d.pageSchema.sessionInterval))+(e.sessionInterval?0:1e7));return t.setHours(0,0,0,0),{enabled:+t<=+new Date,format:e.format||d.addLeadingZeros(t.getDate())+"/"+d.addLeadingZeros(t.getMonth()+1)}},packageStartDate:function(e){var t=d.sessionData.startDate||d.sessionData.package[e]||d.sessionData.created;return new Date(+new Date(1e3*t).setHours(0,0,0,0))},generatePage:function(e,t,a){var n,i,s=e.page,o="";if(s&&(!a||a.enabled)){for(i in o+="<ol>",s)Object.prototype.hasOwnProperty.call(s,i)&&(n=e.page[i].download&&"string"==typeof e.page[i].download.link?e.page[i].download.link:d.sessionData.task[i]&&d.sessionData.task[i].link?d.sessionData.task[i].link:void 0,o+="<li><a class=unselectable"+c.generateEvents(t,i)+"><div>"+(s[i].shortTitle||s[i].title)+"</div></a>"+d.generateDownloadIcon(n)+"</li>");o+="</ol>"}return o},generateSession:function(e,t){var a,n,i,s={},o="",r="";for(a in s.startDate=c.packageStartDate(t),r+='<ol class="sidenav counter" dir=rtl>',e)Object.prototype.hasOwnProperty.call(e,a)&&(s.sessionInterval=e[a].date&&e[a].date.sessionInterval,s.firstSession=!Object.prototype.hasOwnProperty.call(s,"firstSession"),n=c.generateDateObject(s),e[a].highlight&&(o=(o="function"==typeof e[a].highlight?e[a].highlight():e[a].highlight)?' data-highlight="'+o+'"':""),i=e[a].download&&"string"==typeof e[a].download.link?e[a].download.link:void 0,r+="<li><label"+(a===l?" class=expand":"")+(n.enabled?c.generateEvents(a):" disabled")+"><time>"+n.format+"</time><div"+o+">"+(e[a].shortTitle||e[a].title)+"</div>"+d.generateDownloadIcon(i)+"</label>"+c.generatePage(e[a],a,n)+"</li>");return r+="</ol>"},generatePackage:function(e){var t=n[e],a="";return t.session?a+="<div class=sidenav dir=rtl><a class=active"+c.generateEvents()+"><label>"+(t.shortTitle||t.title)+"</label></a></div>"+c.generateSession(t.session,e):a+='<ol class=sidenav dir=rtl><li><label class="expand selected active"'+c.generateEvents(e)+">"+(t.shortTitle||t.title)+"</label>"+c.generatePage(t,e)+"</li></ol>",a}};d.el.content.outerHTML='<div class=container>    <div class="column nav-container" id=sidenav role=navigation dir=ltr>'+Object.keys(n).map(c.generatePackage).join("\n")+'    </div>    <div class="column content" id=content></div></div>',d.el.content=ui.d.getElementById("content"),d.el.sidenav=ui.d.getElementById("sidenav"),d.toggleNav(!0)},o.sessionRefresh=function(e){e?ui.w.location=location.pathname:location.reload()},d.sessionLogin=function(t){t.preventDefault(),ui.form.accessibility(!1,t.target,!0),fetch(d.endpoint+"/login",{method:"POST",redirect:"error",body:JSON.stringify({email:d.el.email.value.toLowerCase(),pass:d.el.pass.value})}).then(function(e){return e.json()}).then(function(e){d.sessionUpdate(e),d.workerUpdate({status:"login"}),ui.setUser(e),ui.form.accessibility(!0,t.target,!0),e.email&&e.token?o.sessionRefresh():d.el.button&&(d.el.button.classList.add("error"),d.el.button.innerHTML="הפרטים שגויים, נסי שוב")}).catch(function(e){ui.log("Unable to login"),ui.log(e),ui.form.accessibility(!0,t.target,!0),d.el.button&&(d.el.button.classList.add("error"),d.el.button.innerHTML="טעות במערכת, נסי שוב מאוחר יותר")})},o.sessionLogout=function(e){delete localStorage.session,e||d.workerUpdate({status:"logout"}),o.sessionRefresh(!0)},d.containsPackage=function(e){return Array.isArray(o.package)?o.package.includes(e):o.package===e},d.getUserCurrentPackage=function(e){if(e&&e.package){if(Object.keys(e.package).includes(d.pageSchema.fullPackage))return d.pageSchema.fullPackage;var t=Object.keys(d.pageSchema.package),a=Object.keys(e.package).filter(function(e){return t.includes(e)});return 1<a.length?a:a[0]}return""},d.getUserDefaultPackage=function(a){var e=d.getUserCurrentPackage(a);return Array.isArray(e)?d.hashData.session&&e.includes(d.hashData.session)?d.hashData.session:e.reduce(function(e,t){return a.package[e]>a.package[t]?e:t}):e},d.sessionUpdate=function(e,t){"object"==typeof e&&(t||d.workerUpdate({status:"update",data:e}),d.sessionData=e,d.sessionData.task||(d.sessionData.task={}),localStorage.session=JSON.stringify(e))},d.sessionVerify=function(a){var t={email:d.sessionData.email,token:d.sessionData.token};fetch(d.endpoint+"/verify",{method:"POST",redirect:"error",body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){var t=d.getUserDefaultPackage(e);return e.error||!t?Promise.reject(e):(d.sessionUpdate(e),"function"==typeof a&&a(t),Promise.resolve(e))}).catch(function(e){console.error(e),d.sessionErrorReport("verify",t)})},d.sessionForgot=function(){d.el.form.removeEventListener("submit",d.sessionLogin),d.el.form.addEventListener("submit",d.sessionRemind),d.el.email.focus(),d.el.pass.parentNode.remove(),d.el.button.innerHTML="שלח לי סיסמא",d.el.button.classList.remove("error"),d.el.link.innerHTML="לנסות להתחבר מחדש",d.el.link.removeEventListener("click",d.sessionForgot),d.el.link.addEventListener("click",o.sessionRefresh)},d.sessionRemind=function(t){t.preventDefault(),ui.form.accessibility(!1,t.target,!0),fetch(d.endpoint+"/forgot",{method:"POST",redirect:"error",body:JSON.stringify({email:d.el.email.value.toLowerCase()})}).then(function(e){return e.json()}).then(function(e){ui.form.accessibility(!0,t.target,!0),e.success?d.el.form.innerHTML="<h2>פרטי גישה נשלחו למייל שלך</h2><a onclick=ui.academy.sessionRefresh(true)>לנסות להתחבר</a>":(d.el.button.classList.add("error"),d.el.button.innerHTML="מייל לא רשום, נסי שוב")}).catch(function(){ui.form.accessibility(!0,t.target,!0),d.el.button&&(d.el.button.classList.add("error"),d.el.button.innerHTML="טעות במערכת, נסי שוב מאוחר יותר")})},d.sessionError=function(){var e;!sessionStorage.sessionError||(e=ui.d.getElementById("session-error"))&&(e.hidden=!1,e.innerHTML=sessionStorage.sessionError,delete sessionStorage.sessionError)},d.sessionErrorReport=function(e,t){"prod"===ui.environment?"sendBeacon"in navigator&&navigator.sendBeacon(d.endpoint+"/error",JSON.stringify({schema:e,email:d.sessionData.email,log:JSON.stringify(t,null,2)})):(console.error(e,t),console.trace&&console.trace()),sessionStorage.sessionError="זהינו שלא פעלת בחשבונך בדקות האחורנות. אנה התחברי שוב.",delete localStorage.session,o.sessionRefresh()},d.sessionPage=function(){var e,t;d.valid&&d.el.content&&(e=d.getCurrentSchema(),t="",delete o.schema,delete o.fn,e&&e.page&&d.hashData.page&&!e.page[d.hashData.page]?(delete d.hashData.page,location.hash=ui.serialize(d.hashData)):!e||d.hashData.session&&d.el.sidenav&&!d.el.sidenav.querySelector('[data-session="'+d.hashData.session+'"]:not([data-page])')?o.sessionRefresh(!0):(d.el.bar&&d.el.bar.checked&&(d.el.bar.checked=!1),!d.hashData.session||d.hashData.session&&!d.hashData.page?(o.schema=e,t+=d.pageUI.generateHTML(e),"function"==typeof e.generateHTML&&(t+=e.generateHTML())):(d.hashData.session&&(e=e.page&&e.page[d.hashData.page]),e&&(o.schema=e,"function"==typeof d.pageUI[d.hashData.page]?(t+=d.pageUI[d.hashData.page](e),d.pageUI[d.hashData.page].fn&&(o.fn=d.pageUI[d.hashData.page].fn)):t+=d.pageUI.generateHTML(e),e.pinterest&&(t+='<div class=pinterest><a data-pin-do=embedBoard data-pin-board-width=900 data-pin-scale-height=631 data-pin-scale-width=115 href="'+d.htmlSafe(e.pinterest)+'"><span class=spin> '+e.pinterest+"</span></a></div>"))),d.el.content.innerHTML=t,e.pinterest&&(ui.w.PinUtils?PinUtils.build():ui.asyncScript("https://assets.pinterest.com/js/pinit.js")),e?(e.video&&ui.video.applyPlyr(),ui.comment&&ui.comment.load(d.el.content)):ui.comment&&ui.comment.remove()))},d.pageUI={},d.pageUI.markdown=function(e){if(!e)return e;var t=function(e){return"<p dir=auto>"+e+"</p>"},a={regex:/\*(\S(.*?\S)?)\*/gm,pattern:"<b>$1</b>"},n={regex:/~(\S(.*?\S)?)~/gm,pattern:"<s>$1</s>"},i={regex:/\[([\s\d\w\u0590-\u05FF%-_]+)\]\(((?:\/|https?:\/\/)[\w\d./?=#]+)\)|(https?:\/\/[^\s:@.,]+\.+[a-z])[^<\s\\!,]{0,}[^<\s\\!|^.,?$]{1,}|[^\s:,/@\-0=]{1,}[a-z0-9\-.]\.com?\/*[^<\s\\!]{1,}[^<\s\\!|^.,$]/gi,pattern:function(){var e=ui.d.createElement("a");return e.href=arguments[2]||arguments[3],e.rel="noopener",e.target="_blank",e.dir="auto",e.textContent=arguments[1]||e.href,e.outerHTML}},s={regex:/([\w.\-+_]+)?\w+@[\w-_]+(\.\w+){1,}/gm,pattern:'<a href="mailto:$&" rel=noopener target=_blank dir=ltr>$&</a>'},o={regex:/05\d{8}/gm,pattern:'<a href="tel:$&" rel=noopener target=_blank dir=ltr>$&</a>'};return e.split("\n").map(t).join("\n").replace(a.regex,a.pattern).replace(n.regex,n.pattern).replace(i.regex,i.pattern).replace(s.regex,s.pattern).replace(o.regex,o.pattern)},d.pageUI.getDownloadLink=function(e){return e&&e.download?d.generateDownloadLink(e.download,e.download.title):""},d.pageUI.generateHTML=function(e){var t,a="";if(e.video&&(a+="<div class=video>",ui.video.youtubeSupport?a+='<iframe src="https://www.youtube.com/embed/'+e.video+'" allow="autoplay; encrypted-media; picture-in-picture; fullscreen" allowfullscreen></iframe>':a+=ui.video.template(e.video),a+="</div>"),"function"==typeof e.text&&(e.text=e.text()),e.video||e.text||e.download){if(a+="<div class=space><h1>"+e.title+"</h1>",e.text&&(a+=d.pageUI.markdown(e.text)),e.page)for(t in e.page)Object.prototype.hasOwnProperty.call(e.page,t)&&(a+='<a class=button href="#session='+d.hashData.session+"&page="+t+'" tabindex=0>'+e.page[t].title+"</a> ");a+=d.pageUI.getDownloadLink(e),a+="</div>"}return a},d.pageUI.generateDate=function(e,t){var a="";return e&&e.date&&(a=new Date(1e3*e.date),a=d.addLeadingZeros(a.getDate())+"/"+d.addLeadingZeros(a.getMonth()+1)+"/"+a.getFullYear(),"string"==typeof t&&(a=t.format(a))),a},d.pageUI.colorSwatch=function(e){var s=d.pageUI.colorSwatch,t=d.sessionData.task.colorSwatch,o=e.question,a={};return s.fn={},s.value={},a.question=function(e){var t=o.option[e];return'<li class="row qa">    <div class=label hidden>'+t.question+"</div>    <select class=unselected name="+e+" onchange=ui.academy.fn.edit(event) data-question data-required required>        <option>"+t.question+"</option>"+Object.keys(t.answer).map(function(e){return"<option value="+e+">"+t.answer[e]+"</option>"}).join("\n")+"    </select></li>"},s.fn.edit=function(e){var t,a,n=e.target,i=n.closest("[data-handler]").querySelector("[data-error]:not([hidden])");switch(n.tagName){case"SELECT":t=n.options[n.selectedIndex].getAttribute("value"),a=n.parentNode.querySelector(".label"),t?(a.hidden=!1,s.value[n.name]=t,n.classList.remove("unselected"),i&&(i.hidden=!0)):(a.hidden=!0,delete s.value[n.name],n.classList.add("unselected"));break;case"TEXTAREA":5<(t=n.value.trim()).length?(s.value[n.name]=t,i&&(i.hidden=!0)):delete s.value[n.name]}n.parentNode.classList.remove("error"),s.value=Object.keys(s.value).sort().reduce(function(e,t){return e[t]=s.value[t],e},{})},s.fn.submit=function(e){var t=e.target,a=Object.keys(o.option),n=Object.keys(s.value),i=t.parentNode.querySelector("[data-error][hidden]");a.push("address"),i&&a.filter(function(e){return!n.includes(e)}).length&&(i.hidden=!1)},a.form=function(){return'<div class="form sum"><h1>'+e.title+'</h1><form name=colorSwatch onsubmit=ui.academy.formSubmit(event) autocomplete=off method=post novalidate><ul class="sheet swipe-pages full">    <li class=page data-handler>        <ul class="table content">'+Object.keys(o.option).map(a.question).join("\n")+'            <li class="row qa">                <textarea name=address oninput=ui.academy.fn.edit(event) placeholder="'+o.address+'" autocomplete="shipping street-address" rows=3 dir=rtl data-required></textarea>            </li>            <li class="row qa">                        <p class=error data-error hidden>'+d.generateIcon("error")+o.error+"</p>                <button onclick=ui.academy.fn.submit(event)>"+o.button+'</button>            </li>            <li class="row qa">                <p>לא בטוחה לאלו צבעים את שייכת? שלחי לי תמונת פנים ברורה שצולמה באור היום לוואטסאפ <a href="https://wa.me/972585800020" target=_blank dir=auto>0585800020</a> או למייל <a href="mailto:lea@laukstein.com" target=_blank dir=auto>lea@laukstein.com</a></p>            </li>        </ul>    </li></ul></form></div>'},a.final=function(){return"<div class=form><h3>"+e.title+"</h3><h1>"+t.title+"</h1><p>"+(t.description||"").replace(/\n/g,"<br>")+d.pageUI.generateDate(t," ההזמנה בוצעה ב {0}.")+"</p>"+d.generateDownloadLink(t,"להורדת סרגל הצבעים")+"</div>"},t?a.final():a.form()},d.pageUI.bodyType=function(a){var e=d.sessionData.task.bodyType,n="",i={height:{min:145,max:280},default:{min:50,max:320}},n=e?'<div class="dialog final">   <div class=table>   <div class=cel>       <h1>'+a.result.format(e.title)+"</h1>       <ol>           <li>"+e.text.join("</li>\n<li>")+"</li>       </ol>       <div>"+d.generateDownloadLink(e,a.download)+"</div>"+d.pageUI.generateDate(e,"<time>בקשה נקלטה ב {0}.</time>")+"   </div>   </div></div>":(Object.keys(a.option).forEach(function(e,t){n+='<li class=row>    <label class="column label" for='+e+">"+a.option[e]+"</label>    <div class=column><input id="+e+" name="+e+" type=number inputmode=numeric min="+(i[e]||i.default).min+" max="+(i[e]||i.default).max+" maxlength=3 dir=ltr data-required"+(t?"":" autofocus")+"></div></li>"}),"<form onsubmit=ui.academy.formSubmit(event) method=post novalidate>    <ul class=sheet>"+n+"</ul>    <div data-status><small><i>"+a.notice+"</i></small></div>    <button>"+a.button+"</button></form>");return'<div class="form calculator">    <h1>'+a.title+"</h1>"+n+"</div>"},d.pageUI.clothesSum=function(l){var c=d.pageUI.clothesSum,a=d.sessionData.task.clothesSum,o={};return c.value=JSON.parse(JSON.stringify(a||{})),c.value.activity||(c.value.activity={}),c.value.question||(c.value.question={}),c.fn={},o.activityField=function(t,a){var e,n,i=ui.generateID(),s=l.activity.option,o=c.value.activity,r="";return t&&s[t]?(Object.keys(s).forEach(function(e){n=e===t||o[e]&&Object.keys(o).indexOf(e)===a?" selected":"",r+="\n<option"+(e?" value="+e:"")+n+">"+s[e]+"</option>"}),r="<select onchange=ui.academy.fn.edit(event)>"+r+"</select>"):(e=s[t||""],r+='<input list="'+i+'" oninput=ui.academy.fn.edit(event)'+(e?' placeholder="'+e+'"':' value="'+d.htmlSafe(t)+'"')+' dir=rtl><datalist id="'+i+'">    <option>'+Object.values(s).join("</option>\n<option>")+"</option></datalist>"),r},o.number=function(e){return e&&String(Number(e))===e?Number(e):e},c.fn.sum=function(){var e=ui.d.getElementById("clothesSum"),t=ui.form.list("input[type=number]",e);o.getName=function(e){if(e)switch(e.tagName){case"SELECT":return e.options[e.selectedIndex].getAttribute("value");case"INPUT":return e.value.trim()}},c.value.activity={},t.forEach(function(e){var t=e.closest("li").querySelector("select, input"),a=o.getName(t),n=o.number(e.value.trim());a&&n&&n===Number(n)&&(c.value.activity[a]&&(n+=c.value.activity[a]),c.value.activity[a]=n)})},o.html={error:function(e){return"<p class=error data-error hidden>"+d.generateIcon("error")+l[e].error+"</p>"},question:function(i){var s=c.value[i],e=Object.keys(l[i].option);return o[i]=function(e){var t=l[i].option[e],a=s[e],n=t.answer;return'<li class="row qa">    <div class=label'+(a?"":" hidden")+">"+t[i]+"</div>    <select"+(a?"":" class=unselected")+" name="+e+" onchange=ui.academy.fn.edit(event) data-question data-required required>        <option>"+t[i]+"</option>"+Object.keys(n).map(function(e){return"<option value="+e+(a===o.number(e)?" selected":"")+">"+n[e]+"</option>"}).join("\n")+"     </select></li>"},'<ul class="table content">'+e.map(o[i]).join("\n")+'    <li class="row qa">'+o.html.error(i)+"        <button class=next onclick=\"ui.academy.fn.submit(event, '"+i+"')\">"+l[i].button.success+"</button>    </li></ul>"},activity:function(t){var a=c.value[t],n=(n=Object.keys(a).concat(Object.keys(l[t].option))).filter(function(e,t){return n.indexOf(e)===t});return o[t]=function(e){return"<li class=row>    <div class=column>"+o.activityField(e)+'    </div>    <div class=column>        <a class="button remove" onclick=ui.academy.fn.removeActivity(event)>'+l[t].button.remove+"</a>        <div class=field-wrap><input type=number"+(a[e]?" value="+a[e]:"")+" placeholder=0 inputmode=numeric oninput=ui.academy.fn.sum()></div>    </div></li>"},o.label=function(e){return'<div class="column label">'+e+"</div>"},c.fn.addActivity=function(e){(e||ui.d.getElementById("clothesSum")).insertAdjacentHTML("beforeend",o[t]())},c.fn.removeActivity=function(e){var t=e.target.parentNode.parentNode,a=t.parentNode;t.remove(),c.fn.sum(),a.childElementCount<2&&c.fn.addActivity(a)},'<div class=content>    <ul class="table sheet-fixed" id=clothesSum>        <li class=row>'+l[t].label.map(o.label).join("\n")+"        </li>"+n.map(o[t]).join("\n")+"    </ul>    <p><a onclick=ui.academy.fn.addActivity()>"+l[t].button.create+"</a></p>"+o.html.error(t)+"    <button class=next onclick=\"ui.academy.fn.submit(event, '"+t+"')\">"+l[t].button.success+'</button>    <span class="back unselectable" onclick=ui.academy.fn.slide()>'+l[t].button.back+"</span></div>"},sum:function(i,e){var t="";return e&&(o.label=function(e,t){return'<div class="column nowrap'+(t?"":" name")+'">'+e+"</div>"},o.locale=function(e){return l.activity.option[e]||l[i].option[e]&&l[i].option[e].title||d.htmlSafe(e)},o.sets=function(e){var t,a=o.hasDress(),n=[];return e.set1&&(t=a?"jacket":"skirt",n.push("<span class=nowrap>"+e.set1+" "+l[i].sets[t]+"</span>")),e.set2&&(t=a?"dress":"shirt",n.push("<span class=nowrap>"+e.set2+" "+l[i].sets[t]+"</span>")),n.join("<br>")},o.line=function(e){var t=o.locale(e.name);return'<li class=row>    <div class="column nowrap name" title="'+t+'">'+t+'</div>    <div class="column nowrap">'+e.sets+'</div>    <div class="column nowrap">'+o.sets(e)+"</div></li>"},o.group=function(e){return e.map(o.line).join("\n")},t+='<div class=content>    <ul class="table sheet sheet-fixed sheet-zebra result">        <li class="row labels">'+l[i].label.map(o.label).join("\n")+"</li>"+e.map(o.group).join("\n")+"    </ul>"+d.pageUI.generateDate(a,"<time>בקשה נקלטה ב {0}.</time>")+"    <a class=footer-link onclick=ui.academy.fn.slide()>"+l[i].button.retry+"</a></div>"),t},page:function(e,t){return"<li class=page id="+e+" data-handler>"+o.html[e](e,t)+"</li>"},loading:function(){return'<div class="content sheet center">'+d.loadingHTML+"</div>"},all:function(){return o.html.page("question")+o.html.page("activity")+o.html.page("sum",o.result())}},o.isValid={question:function(e){return Object.keys(l[e].option).length===Object.keys(c.value[e]).length},activity:function(e){return!!Object.keys(c.value[e]).length},all:function(){return o.isValid.question("question")&&o.isValid.activity("activity")}},o.result=function(){if(o.isValid.all()){var s=o.hasDress();return o.sumCloth=function(e){e=e||1;function t(){var e;a<n&&(e=n,n=a,a=e)}var a=Math.max(1,Math.floor(e/2)),n=1;if(1===a)a=e;else for(;a;){if(n=Math.max(1,Math.floor(e/a)),a-1<n){n*a+1===e&&(t(),e+1<n*(a+=1)&&(n=Math.max(1,Math.floor(e/a)))),a<e*n&&(a=Math.max(1,Math.floor((e+1)/n)));break}--a}return t(),{set1:n,set2:a}},o.result=function(){var t,a=l.sum.option,i={activity:[],adds:[]};return Object.keys(c.value.activity).forEach(function(e){var t="shabbat"===e?c.value.question.shabbat:1,a=s?2:0,n=c.value.activity[e]*t+a;i.activity.push(Object.assign({name:e,sets:n},o.sumCloth(n)))}),t=i.activity.reduce(function(e,t){return e+t.sets},0),Object.keys(a).forEach(function(e){"cover"===e&&"yes"!==c.value.question.cover||i.adds.push({name:e,sets:Math.max(1,Math.round(t*a[e].perc/100))})}),Object.values(i)},o.result()}},c.fn.slide=function(e){ui.d.getElementById("slide").style[d.getStyleProperty("transform")]="translateX("+100*(e||0)+"%)"},c.fn.slideStyle=function(e){var t,a=0;return o.isValid.question("question")&&(a+=1,o.isValid.activity("activity")&&(a+=1)),t="translateX("+100*(a||0)+"%)",e?d.getStyleProperty("transform")+":"+t+";":t},o.hasDress=function(){return"shabbat"===c.value.question.dress||"yes"===c.value.question.dress},c.fn.edit=function(e){var t,a,n=l.activity.option,i=e.target,s=i.closest("[data-handler]").querySelector("[data-error]:not([hidden])");switch(i.tagName){case"SELECT":t=o.number(i.options[i.selectedIndex].getAttribute("value")),i.hasAttribute("data-question")?(a=i.parentNode.querySelector(".label"),t?(a.hidden=!1,c.value.question[i.name]=t,i.classList.remove("unselected"),s&&(s.hidden=!0)):(a.hidden=!0,delete c.value.question[i.name],i.classList.add("unselected")),i.parentNode.classList.remove("error")):(t||(i.parentNode.innerHTML=o.activityField(t)),c.fn.sum(),s&&Object.keys(c.value.activity).length&&(s.hidden=!0));break;case"INPUT":t=o.number(i.value.trim()),Object.keys(n).forEach(function(e){n[e]===t&&(t=e)&&(i.parentNode.innerHTML=o.activityField(t)),c.fn.sum()})}},c.fn.submit=function(e,t){var a={};if(a.handler=ui.d.getElementById(t),a.error=a.handler.querySelector("[data-error]"),o.toggleError=function(e){a.error.hidden=!e},"question"===t){if(e.preventDefault(),o.isValid[t](t))return o.toggleError(!1),c.fn.slide(1),!0;o.toggleError(!0)}if("activity"===t){if(o.isValid[t](t))return JSON.stringify(c.value)===JSON.stringify(d.sessionData.task.clothesSum||{})?e.preventDefault():(a.handler=ui.d.getElementById("sum"),a.handler.innerHTML=o.html.loading()),o.toggleError(!1),c.fn.slide(2),!0;e.preventDefault(),o.toggleError(!0)}return!1},o.timer&&(clearTimeout(o.timer),delete o.timer),'<div class="form sum">    <h1>'+l.title+'</h1>    <form name=clothesSum onsubmit=ui.academy.formSubmit(event) autocomplete=off method=post novalidate>        <ul class="sheet swipe-pages full" id=slide style="'+c.fn.slideStyle(!0)+'">'+o.html.all()+"</ul>    </form></div>"},d.pageUI.dressStyle=function(r){var i=d.pageUI.dressStyle,e=d.sessionData.task.dressStyle,t="",c=0,u=[],l={},t=e?'<div class="dialog final">   <div class=table>   <div class=cel>       <h1>'+e.title+"</h1>       <div>"+d.generateDownloadLink(e,r.downloadButton)+"</div>"+d.pageUI.generateDate(e,"<time>בקשה נקלטה ב {0}.</time>")+"   </div>   </div></div>":(i.fn={},i.fn.navigate=function(e){var t,a,n;e&&(t=ui.d.getElementById("slide"),a=e.hasAttribute("data-next"),n=ui.academy.schema.option,a?c<n.length-1&&(c+=1):(u[c]&&!Array.isArray(u[c])&&u.splice(c,1),--c),(n=n[Math.abs(c)])&&"function"!=typeof n.condition||n.condition(l.calc(u))?t&&(t.style[d.getStyleProperty("transform")]="translateX("+100*c+"%)"):(--c,i.fn.done(e)))},i.fn.check=function(e){var t,a=e.closest("[data-handler]"),n=a.querySelector("[data-next]"),i=d.getDataAttribute(a,"max"),s=ui.form.deserialize(a),o=Object.keys(s),r=o.length,i=i?Number(i)-1:1,l=function(e){for(t=0;t<e.length;t+=1)i<r?e[t].setAttribute("disabled",""):e[t].removeAttribute("disabled")};o.length?u[c]=0===i?{final:o[0]}:o:u[c]&&!Array.isArray(u[c])&&u.splice(c,1),r?n.removeAttribute("disabled"):n.setAttribute("disabled",""),l(ui.form.list("input:not(:checked)",a)),l(ui.form.list("input:not(:checked) ~ label",a))},i.fn.done=function(e){o.formSubmit(e.closest("[data-handler]"),u)},l.calc=function(t){var a=[].concat.apply([],t).map(function(e){return"object"==typeof e&&e.final?{count:t.length+1,name:e.final}:{count:1,name:e}}).reduce(function(e,t){return e[t.name]=(e[t.name]||0)+t.count,e},{}),e=Object.keys(a),n=Math.max.apply(null,e.map(function(e){return a[e]})),i=e.reduce(function(e,t){return a[t]===n&&e.push(t),e},[]);if(2<i.length)return["A"];if(2===i.length)switch(JSON.stringify(i).replace(/[[,\]]/g,"")){case"AB":case"AC":case"AD":case"AE":return["A"];case"BC":case"BD":case"BE":return["B"];case"CE":return["F"];case"DE":return["G"]}return i},l.option=function(e,t,a){var n=ui.generateID();return t="object"==typeof t?t.title:t,"<li"+(a?" class=box":"")+">    <input name="+e+" id="+n+" onclick=ui.academy.fn.check(this) type=checkbox>"+(a?"<figure><img class=absolute src=/assets/academy-style-"+e.toLowerCase()+'.jpg alt="'+t+'"></figure>':"")+'    <label class="column label wrap" for='+n+">"+d.generateIcon("check")+t+"</label></li>"},l.group=function(e,t,a){for(var n=Object.keys(e.option||{}),i="",s="",o=0;o<n.length;o+=1)i+=l.option(n[o],e.option[n[o]],e.showImage);return Object.prototype.hasOwnProperty.call(e,"option")||(e.callback=l.group,e.params=arguments,e.id=ui.generateID(),s=" id="+e.id+" data-max=1"),'<li class="qa page"'+s+" data-handler>    <h4 class=wrap>"+t+". "+e.title+"</h4>    <small class=wrap><i>"+(e.limit||r.limit)+"</i></small>    <ol"+(e.showImage?" class=grid":"")+">"+i+"</ol>"+(t===a?"    <button class=next onclick=ui.academy.fn.done(this) data-next disabled>"+r.button+"</button>":"    <button class=next onclick=ui.academy.fn.navigate(this) data-next disabled>"+r.next+"</button>")+(1<t?'    <span class="back unselectable" onclick=ui.academy.fn.navigate(this) data-back>'+r.back+"</span>":"")+"</li>"},l.form=function(e){for(var t=e.option,a="",n=0;n<t.length;n+=1)a+=l.group(t[n],n+1,t.length);return a},'<form onsubmit=event.preventDefault() method=post novalidate>    <ul class="sheet swipe-pages" id=slide>'+l.form(r)+"</ul></form>");return'<div class="form sat">    <h1>'+r.title+"</h1>"+t+"</div>"},d.workerRegister=function(){"https:"===location.protocol&&"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(function(){navigator.serviceWorker.addEventListener("message",function(e){e.data&&d.workerUpdate(e.data,!0)})})},d.workerUpdate=function(e,t){if("object"==typeof e&&navigator.serviceWorker&&navigator.serviceWorker.controller)if("dev"===ui.environment&&console.log("ServiceWorker",e),t)switch(e.status){case"login":return location.reload();case"logout":return o.sessionLogout(!0);case"update":return d.sessionUpdate(e.data,!0)}else navigator.serviceWorker.controller.postMessage(e)},d.generateIcon=function(e){return"<svg class=icon-"+e+"><use xlink:href=#"+e+" /></svg>"},d.generateDownloadLink=function(e,t){return e&&t&&e.link?Array.isArray(e.link)?e.link.map(function(e){return d.generateDownloadLink({link:e},t)}).join(""):'<a class=button href="'+e.link+'" rel=noopener target=_blank tabindex=0>'+d.generateIcon("download")+t+"</a>":""},d.generateDownloadIcon=function(e){return Array.isArray(e)?e.map(d.generateDownloadIcon).filter(Boolean).join(""):e&&"string"==typeof e?'<a class=link-download href="'+e+'" rel=noopener target=_blank tabindex=-1>'+d.generateIcon("download")+"</a>":""},d.getDataAttribute=function(e,t){if(e&&1===e.nodeType)return e.dataset?e.dataset[t]:e.getAttribute("data-"+t)},d.getStyleProperty=function(e){var t,a,n=["Webkit","Moz","ms"],i=ui.d.documentElement.style;if(e){if((e=e.toLowerCase().replace(/-([a-z])/g,function(e,t){return t.toUpperCase()}))in i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1),a=0;a<n.length;a+=1)if((t=n[a]+e)in i)return t}return null},d.addLeadingZeros=function(e){return("0"+String(e)).slice(-2)},d.htmlSafe=function(e){return e?e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,"&#13;").replace(/[\r\n]/g,"&#13;"):""},d.getCurrentSchema=function(){var e,t=d.getUserDefaultPackage(d.sessionData),a=d.pageSchema.package[t];return d.hashData.session?(e=a.session)&&e[d.hashData.session]||a:-1===location.href.indexOf("#")||!location.hash&&!history.replaceState?a:null},d.toggleNav=function(e){var t,a;d.hashData=ui.hash(),d.el.sidenav&&((t=d.getCurrentSchema())&&(d.toggleNav.applyClass(d.el.sidenav.querySelector(location.hash?'[data-session="'+d.hashData.session+'"]:not([data-page])':"a")),t.page&&t.page[d.hashData.page]&&d.toggleNav.applyClass(d.el.sidenav.querySelector('[data-session="'+d.hashData.session+'"][data-page="'+d.hashData.page+'"]'))),!0!==e||location.hash||(a=d.el.sidenav.querySelectorAll("[data-session]:not([data-page])"),d.toggleNav.applyClass(a[a.length-1]))),d.sessionPage()},d.toggleNav.applyClass=function(n){var e,i,s={};d.el.sidenav&&(s.session=d.el.sidenav.querySelector(".expand"),s.active=d.el.sidenav.querySelector(".active"),s.page=d.el.sidenav.querySelector(".selected")),d.hashData.previous={session:d.getDataAttribute(s.session,"session"),page:d.getDataAttribute(s.page||s.active,"page")},(e=function(e,t,a){!a&&d.hashData.previous[e]===d.hashData[e]||(s[e]&&(s[e].classList.remove(t),s[e].nextElementSibling&&"OL"===s[e].nextElementSibling.tagName&&ui.form.list("a",s[e].nextElementSibling).forEach(function(e){e.tabIndex=-1}),ui.d.activeElement===s[e]&&s[e].blur()),i=i||!0,n&&(n.classList.add(t),n.nextElementSibling&&"OL"===n.nextElementSibling.tagName&&ui.form.list("a",n.nextElementSibling).forEach(function(e){e.tabIndex=0})))})("session","expand"),e("page","selected",!!i),e("active","active",!!i)},o.navClick=function(e,t){var a;e&&(a={session:d.getDataAttribute(e,"session"),page:d.getDataAttribute(e,"page")},d.hashData.session===a.session&&d.hashData.page===a.page?e.classList.add("expand"):(a=ui.serialize(a),!t&&a?(location.hash=a,ui.d.body.scrollTop=0):(a||!location.hash)&&d.pageSchema.session[d.hashData.session]||(location.hash="",history.replaceState&&history.replaceState("",ui.d.title,location.pathname))))},o.navKeydown=function(e){e&&e.target&&13===(e.keyCode||e.which)&&(e.preventDefault(),e.target.click())},o.formSubmit=function(e,t){var a,n,i=e instanceof Event&&e,s=e&&e.target||e;if(i&&i.preventDefault(),ui.form.valid(ui.form.list("[data-required]",s))){switch(n=d.hashData.page,a={email:d.sessionData.email,token:d.sessionData.token,data:{}},ui.form.accessibility(!1,s,!0,"dressStyle"===n&&"label"),n){case"bodyType":a.data[n]=Object.assign({date:Math.floor(new Date/1e3)},ui.form.deserialize(s));break;case"clothesSum":case"colorSwatch":a.data[n]=Object.assign({date:Math.floor(new Date/1e3)},d.pageUI[n].value);break;case"dressStyle":a.data[n]={date:Math.floor(new Date/1e3),value:t},s.closest("[data-handler]").querySelector("[data-back]").remove()}a.data[n]?fetch(d.endpoint+"/update",{method:"POST",redirect:"error",body:JSON.stringify(a)}).then(function(e){return e.json()}).then(function(e){return e.error?Promise.reject(e):e}).then(function(e){d.sessionUpdate(e),o.sessionRefresh()}).catch(function(){d.sessionErrorReport("update",a)}):console.error(n,a.data[n])}},d.pageSchemaSetup=function(e){var t=Object.keys(d.sessionData.package),a=e===d.pageSchema.fullPackage;d.pageSchema.package.full.session.closet.page.bodyType=d.pageSchema.package.full.session.bodyShape.page.bodyType,d.pageSchema.package.full.session.shopping.page.bodyType=d.pageSchema.package.full.session.bodyShape.page.bodyType,d.pageSchema.package.full.session.shopping.page.colorSwatch=d.pageSchema.package.full.session.colours.page.colorSwatch,d.pageSchema.package.full.session.shopping.page.dressStyle=d.pageSchema.package.full.session.style.page.dressStyle,d.pageSchema.package.closet=d.pageSchema.package.full.session.closet,d.pageSchema.package.shopping=d.pageSchema.package.full.session.shopping,Object.keys(d.pageSchema.package).forEach(function(e){(!t.includes(e)||a&&d.pageSchema.fullPackage!==e)&&delete d.pageSchema.package[e]}),o.package=d.getUserCurrentPackage(d.sessionData)},d.init=function(){return ui.legacy(function(){d.el.form=ui.d.getElementById("form"),d.el.form.addEventListener("submit",d.sessionLogin),d.el.bar=ui.d.getElementById("bar"),d.el.button=ui.d.getElementById("button"),d.el.content=ui.d.getElementById("content"),d.el.details=ui.d.getElementById("details"),d.el.email=ui.d.getElementById("email"),d.el.link=ui.d.getElementById("link"),d.el.link.addEventListener("click",d.sessionForgot),d.el.pass=ui.d.getElementById("pass"),d.valid=!!d.sessionData.email&&!!d.sessionData.token,d.workerRegister();function t(){var e=ui.d.getElementById("loading");e&&(d.loadingHTML=e.innerHTML,e.remove()),d.el.content.removeAttribute("hidden"),d.el.details.removeAttribute("hidden")}d.valid?d.sessionVerify(function(e){t(),d.pageSchemaSetup(e),d.sessionLogedin(),ui.identify.all()}):d.sessionData.email?(t(),d.el.email.value=d.sessionData.email,setTimeout(function(){d.el.pass.focus()},0)):t(),ui.w.addEventListener("hashchange",d.toggleNav),d.sessionError()}),o},ui.academy=d.init()}();
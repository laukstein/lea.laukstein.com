ui.videos=function(){"use strict";var r=ui.d.getElementById("content"),o=ui.d.title,a=new Date,i=0,t={};function n(){if(ui.w.IntersectionObserver&&!n.error)try{!n.initDefined&&ui.w.IntersectionObserver&&ui.w.IntersectionObserverEntry&&"intersectionRatio"in ui.w.IntersectionObserverEntry.prototype&&!("isIntersecting"in IntersectionObserverEntry.prototype)&&Object.defineProperty(ui.w.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}});var e=ui.d.querySelectorAll("img[data-src]");e=e.length?Array.from&&Array.from(e)||[].slice.call(e):[],n.initDefined=!0,e.forEach(function(e){n.observer.observe(e)})}catch(e){n.error=e}}function s(e,t){var i,r,o,a,n="";if(ui.videos.legacy)t?e[t]&&!e[t].academy&&((o=e[t]).resourceId={videoId:t},n+=s.loop(o,"video")):(i=function(e,o){var t,i=[],r={};for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&i.push([t,e[t]]);return i.sort(function(e,t){var i=e[1][o],r=t[1][o];return i<r?1:r<i?-1:0}),i.forEach(function(e){r[e[0]]=e[1]}),r}(ui.filterObj(e,function(e,t){return t[e].public}),"publishedAt"),Object.keys(i).forEach(function(e){(o=i[e]).resourceId={videoId:e},n+=s.loop(o,"image")}));else for(a=0;!r&&a<e.length;a+=1)(o=e[a].snippet)&&(t?o.resourceId&&o.resourceId.videoId===t?(n+=s.loop(o,"video"),r=!0):ui.videosList&&ui.videosList[t]&&!ui.videosList[t].academy&&(o=ui.videosList[t],n+=s([{snippet:{resourceId:{videoId:t},thumbnails:{maxres:{url:o.image}},title:o.title,description:o.description,publishedAt:o.publishedAt}}],t),r=!0):n+=s.loop(o,"image"));return n}return n.observer=ui.w.IntersectionObserver&&new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&e.target.dataset.src&&(e.target.src=e.target.dataset.src,e.target.removeAttribute("data-src"),n.observer.unobserve(e.target))})},{rootMargin:"200px 0px",threshold:.01}),s.safe=function(e){return void 0===e?"":String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},s.loop=function(e,t){return this[t||"image"]({id:e.resourceId&&encodeURIComponent(e.resourceId.videoId),image:e.thumbnails&&(e.thumbnails.maxres&&encodeURI(e.thumbnails.maxres.url)||e.thumbnails.standard&&encodeURI(e.thumbnails.standard.url)||e.thumbnails.high&&encodeURI(e.thumbnails.high.url)),title:this.safe(e.title),description:this.safe(e.description).replace(/\n/g,"<br>"),date:function(){try{return e.publishedAt&&new Date(e.publishedAt).toLocaleDateString("he",{year:"numeric",month:"long",day:"numeric"})}catch(e){}}()})},s.links=function(e){var t={regex:/(https?:\/\/[^\s:@.,]+\.+[a-z])[^<\s\\!,]{0,}[^<\s\\!|^.,?$]{1,}|[^\s:,/@\-0=]{1,}[a-z0-9\-.]\.com?\/*[^<\s\\!]{1,}[^<\s\\!|^.,$]/gi,pattern:'<a href="$&" rel=noopener target=_blank dir=auto>$&</a>'},i={regex:/([\w.\-+_]+)?\w+@[\w-_]+(\.\w+){1,}/gm,pattern:'<a href="mailto:$&" rel=noopener target=_blank dir=ltr>$&</a>'},r={regex:/05\d{8}/gm,pattern:'<a href="tel:$&" rel=noopener target=_blank dir=ltr>$&</a>'};return e&&e.replace(t.regex,t.pattern).replace(i.regex,i.pattern).replace(r.regex,r.pattern)},s.image=function(e){return e.image=ui.video.youtubeSupport?e.image:ui.video.getData(e.id).image,e.image?"<li class=box>    <figure class=play><img "+(ui.w.IntersectionObserver?"data-":"")+'src="'+e.image+'" alt="'+e.title+'"></figure>    <a class=absolute href="#'+e.id+'" aria-label="'+e.title+'" tabindex=0></a>    <h2 class=wrapline>'+e.title+"</h2>"+(e.description?"    <p>"+this.links(e.description)+"</p>":"")+(e.date?"    <div><time>"+e.date+"</time></div>":"")+"</li>":""},s.video=function(e){return ui.d.title=e.title||"סרטון",'<article class="box card" dir=ltr>    <div class=video>'+(ui.video.youtubeSupport?'<iframe src="https://www.youtube.com/embed/'+e.id+'?autoplay=1" allow="autoplay; encrypted-media; fullscreen" allowfullscreen></iframe>':ui.video.template(e.id))+"    </div>    <div class=content dir=rtl>        <h1>"+e.title+"</h1>"+(e.description?"        <p>"+this.links(e.description)+"</p>":"")+(e.date?"        <div><time>"+e.date+"</time></div>":"")+"    </div></article>"},s.list=function(e){return"<div class=space>    <p>סרטונים ביוטיוב</p>    <div id=g-ytsubscribe class=g-ytsubscribe data-channelid=UCNNsgimJtU1q1LUMVsq44Dg data-layout=full data-count=hidden></div></div><ul class=list>"+e+"</ul>"},s.paintUI=function(e){var t,i=location.hash;i=i&&i.substring(1),(e=ui.videos||e)&&"object"==typeof e.items&&((t=s(e.items,i))?(i?e.scrollTop=ui.d.documentElement.scrollTop:ui.d.title=o,ui.isLoaded||(r.classList.remove("center"),r.classList.add("table","scale","space","medium","no-padding")),r.innerHTML=i?t:s.list(t),setTimeout(function(){i=location.hash&&location.hash.substring(1),ui.d.documentElement.scrollTop=i?0:e.scrollTop||0},10),ui.isLoaded||(ui.video.youtubeSupport&&ui.asyncScript("https://apis.google.com/js/platform.js",{remove:!0}),ui.isLoaded=!0),ui.comment&&(i?ui.comment.load(r):(ui.comment.remove(),ui.w.gapi&&gapi.ytsubscribe.go())),i?(n.observer&&n.observer.disconnect(),ui.video.applyPlyr()):n()):(i&&(location.hash=""),history.replaceState&&setTimeout(function(){history.replaceState({},ui.d.title,location.pathname)},0)))},t.call=function(e){delete localStorage.videos,fetch(e).then(function(e){return e.json()}).then(function(e){return t.getData(e,!0)}).catch(t.local)},t.success=function(e){return(e=e||{}).error?this.error(e):(e.downloadTime=+a,localStorage.videos=JSON.stringify(e),ui.videos=e,s.paintUI(e),ui.videos=e,ui.w.addEventListener("hashchange",s.paintUI),history.scrollRestoration&&(history.scrollRestoration="manual"),e)},t.error=function(e){return delete localStorage.videos,e=e||{},(r=r&&r.querySelector("strong"))&&(r.innerHTML="שגיאת שרת, <a href>נסה שוב</a> או מאוחר יותר."),ui.videos=e},t.getData=function(e,t){if(3<(i+=1))return this.error();if(e&&function(e){var t,i;try{e=JSON.parse(e)}catch(e){}try{t=e&&e.downloadTime&&new Date(Number(e.downloadTime))||a}catch(e){return 0}return t=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),i=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()),Math.abs(Math.floor((i-t)/864e5))}(e)<1){if(t)return this.success(e);try{return this.success(JSON.parse(e))}catch(e){return this.call(ui.video.playlistLink)}}return this.call(ui.video.playlistLink)},t.local=function(){return!sessionStorage["ui.videosList"]&&ui.videosList&&(sessionStorage["ui.videosList"]=JSON.stringify(ui.videosList)),t.legacy()},t.legacy=function(){if("object"!=typeof ui.videosList||!Object.keys(ui.videosList).length)return t.error();ui.videos={legacy:!0,items:ui.videosList},s.paintUI(ui.videos),ui.w.addEventListener("hashchange",s.paintUI),history.scrollRestoration&&(history.scrollRestoration="manual")},r?ui.legacy(function(){localStorage.videos?t.getData(localStorage.videos):t.legacy()}):console.error("Missing container element"),localStorage.videosDate&&delete localStorage.videosDate,ui.videos||{}}();